<Page x:Class="Kiosk.Pages.FaceRecognitionPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:views="clr-namespace:Kiosk.Views"
      Title="">

    <Grid Background="Black">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <!-- 헤더 -->
        <views:HeaderView Grid.Row="0">
            <views:HeaderView.Content>
                <Grid>
                    <!-- 왼쪽: 날짜/시간 + 지점명 -->
                    <StackPanel Orientation="Vertical" HorizontalAlignment="Left" VerticalAlignment="Center"
                                Margin="10,0">
                        <TextBlock Text="{Binding Model.CurrentDateTime, StringFormat='{}{0:yyyy.MM.dd HH:mm}'}"
                                   Foreground="White" FontSize="20" />
                        <TextBlock Text="{Binding Model.LocationName}"
                                   Foreground="White" FontSize="18" />
                    </StackPanel>

                    <!-- 가운데: 기존 로고 이미지 -->
                    <Image Source="/Images/Logo.png"
                           Height="50"
                           VerticalAlignment="Center"
                           HorizontalAlignment="Center" />
                    <!-- 오른쪽: 버튼2개 -->
                    <StackPanel Orientation="Horizontal"
                                HorizontalAlignment="Right"
                                VerticalAlignment="Center"
                                Margin="0,0,10,0">
                        <Button Style="{StaticResource ImageButtonStyle}" Click="OnPhoneClick" Margin="0,0,30,0">
                            <Image Source="/Images/btnPhone.png" Height="40" />
                        </Button>
                        <Button Style="{StaticResource ImageButtonStyle}" Click="OnMapClick" Margin="0,0,10,0">
                            <Image Source="/Images/btnPin.png" Height="40" />
                        </Button>
                    </StackPanel>
                </Grid>
            </views:HeaderView.Content>
        </views:HeaderView>
        <!-- 콘텐츠 -->
        <Grid Grid.Row="1">
            <!-- 겹쳐진 요소들 -->
            <Grid x:Name="RootGrid">
                <!-- 1. 카메라 영상 -->
                <Image Source="{Binding CameraFrame}"
                       Stretch="UniformToFill"
                       HorizontalAlignment="Center"
                       VerticalAlignment="Center" />
                <!-- 2. 마스킹 + 프레임 -->
                <Grid Background="Transparent">
                    <Canvas Background="Transparent">
                        <Path x:Name="MaskingPath" Fill="#99000000" IsHitTestVisible="False" />
                    </Canvas>
                </Grid>
                <!-- 3. 안내 문구 -->
                <TextBlock Text="{Binding Model.StatusText}"
                           HorizontalAlignment="Center"
                           VerticalAlignment="Bottom"
                           Foreground="White"
                           Margin="0,0,0,100"
                           FontWeight="Bold"
                           FontSize="25" />
            </Grid>
            <!-- 4. 대기자 명단 -->
            <Border Background="#10000000" Padding="0"
                    HorizontalAlignment="Right" VerticalAlignment="Bottom"
                    Width="100" Height="150">
                <ListBox ItemsSource="{Binding Model.WaitUsers}" Background="Transparent" BorderThickness="0">
                    <ListBox.ItemTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding MaskedName}" Foreground="White" FontSize="20" />
                        </DataTemplate>
                    </ListBox.ItemTemplate>
                    <ListBox.ItemContainerStyle>
                        <Style TargetType="ListBoxItem">
                            <Setter Property="Background" Value="Transparent" />
                            <Setter Property="BorderThickness" Value="0" />
                            <Setter Property="Focusable" Value="False" />
                        </Style>
                    </ListBox.ItemContainerStyle>
                </ListBox>
            </Border>
        </Grid>
    </Grid>
</Page>